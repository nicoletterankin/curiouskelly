# Kelly Asset Pack Generator - Complete Workflow

Visual guide to the entire asset generation pipeline.

---

## Input â†’ Output Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INPUT IMAGES                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ kelly2-directors-chair.jpeg (16:9 hero, director's chair)        â”‚
â”‚  â€¢ Kelly Source.jpeg (fallback)                                     â”‚
â”‚  â€¢ reference_kelly_image.png (portrait for sprite)                  â”‚
â”‚  â€¢ ChatGPT Image Oct 9, 2025, 01_17_55 PM.png (tight portrait)     â”‚
â”‚  â€¢ Avatar IV Video (1).mp4 (optional video)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      STEP 1: LOAD & CROP                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [io_utils.load_image]                                              â”‚
â”‚       â†“                                                              â”‚
â”‚  [crop_scale.crop_to_aspect] â†’ Center-crop to 16:9                  â”‚
â”‚       â†“                                                              â”‚
â”‚  [crop_scale.resize_lanczos] â†’ Scale to 7680Ã—4320 (8K)             â”‚
â”‚       â†“                                                              â”‚
â”‚  Result: hero_rgb (7680Ã—4320 RGB)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   STEP 2: HAIR MATTING                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Process at compute-friendly 2K:                                    â”‚
â”‚  [crop_scale.resize_lanczos] â†’ 2560Ã—1440                           â”‚
â”‚       â†“                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ Model-Based (try)   â”‚  [matting.model_based_matting]            â”‚
â”‚  â”‚   UÂ²-Net portrait   â”‚  â€¢ Auto-download weights                   â”‚
â”‚  â”‚   GPU acceleration  â”‚  â€¢ Deep learning inference                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚       â†“ (if fails)                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ Heuristic (fallback)â”‚  [matting.heuristic_matting]              â”‚
â”‚  â”‚   Luminance-chroma  â”‚  â€¢ Whiteness detection                     â”‚
â”‚  â”‚   Smoothstep alpha  â”‚  â€¢ No external deps                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚       â†“                                                              â”‚
â”‚  Result: base_alpha_2k (2560Ã—1440)                                  â”‚
â”‚       â†“                                                              â”‚
â”‚  [matting.guided_upsample_alpha] â†’ Edge-aware upsample to 8K       â”‚
â”‚       â†“                                                              â”‚
â”‚  Result: base_alpha (7680Ã—4320)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  STEP 3: ALPHA VARIANTS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [alpha_tools.generate_alpha_variants]                              â”‚
â”‚       â†“                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Soft Alpha (for light UIs)                                  â”‚   â”‚
â”‚  â”‚   â€¢ Gaussian blur (radius=2.0)                              â”‚   â”‚
â”‚  â”‚   â€¢ Positive bias (+0.05)                                   â”‚   â”‚
â”‚  â”‚   â†’ Graceful halo, wispy strands                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â†“                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Tight Alpha (for dark UIs)                                  â”‚   â”‚
â”‚  â”‚   â€¢ Gaussian blur (radius=1.0)                              â”‚   â”‚
â”‚  â”‚   â€¢ Negative bias (-0.03)                                   â”‚   â”‚
â”‚  â”‚   â€¢ Morphological erosion (1px)                             â”‚   â”‚
â”‚  â”‚   â†’ No white halo, clean edges                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â†“                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Edge Matte (compositing control)                            â”‚   â”‚
â”‚  â”‚   â€¢ Edge = Soft - Tight                                     â”‚   â”‚
â”‚  â”‚   â†’ Isolated halo channel                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â†“                                                              â”‚
â”‚  Result: alpha_soft, alpha_tight, alpha_edge                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: 16:9 HERO   â”‚ â”‚ STEP 5: DARK â”‚ â”‚ STEP 6: SQ. SPRITE  â”‚
â”‚      TRANSPARENT     â”‚ â”‚     HERO     â”‚ â”‚   (8192Ã—8192)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Combine RGB + alpha  â”‚ â”‚ Create grad. â”‚ â”‚ Load portrait src   â”‚
â”‚ [composite.          â”‚ â”‚ [composite.  â”‚ â”‚ [matting.generate_  â”‚
â”‚  create_rgba]        â”‚ â”‚  create_ver. â”‚ â”‚  alpha]             â”‚
â”‚   â†“                  â”‚ â”‚  tical_grad. â”‚ â”‚   â†“                 â”‚
â”‚ hero_rgba            â”‚ â”‚  (#22262A    â”‚ â”‚ Generate soft alpha â”‚
â”‚ (7680Ã—4320)          â”‚ â”‚   â†’ #080808)]â”‚ â”‚   â†“                 â”‚
â”‚   â†“                  â”‚ â”‚   â†“          â”‚ â”‚ [crop_scale.        â”‚
â”‚ OUTPUT #1:           â”‚ â”‚ [composite.  â”‚ â”‚  prepare_square_    â”‚
â”‚ kelly_directors_     â”‚ â”‚  composite_  â”‚ â”‚  sprite]            â”‚
â”‚ chair_8k_            â”‚ â”‚  over_bg]    â”‚ â”‚ â€¢ Find bounds       â”‚
â”‚ transparent.png      â”‚ â”‚   â†“          â”‚ â”‚ â€¢ Scale to fit      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ OUTPUT #2:   â”‚ â”‚ â€¢ Center on canvas  â”‚
                         â”‚ kelly_direc. â”‚ â”‚ â€¢ Apply padding     â”‚
                         â”‚ chair_8k_    â”‚ â”‚   â†“                 â”‚
                         â”‚ dark.png     â”‚ â”‚ OUTPUT #3:          â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ kelly_front_square_ â”‚
                                          â”‚ 8k_transparent.png  â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 7: DIFFUSE     â”‚ â”‚ STEP 8: ALPHAâ”‚ â”‚ STEP 9: PHYSICS     â”‚
â”‚      NEUTRALS        â”‚ â”‚   UTILITIES  â”‚ â”‚    REFERENCE        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [diffuse.gray_world_ â”‚ â”‚ Save alphas: â”‚ â”‚ [physics_sheet.     â”‚
â”‚  balance]            â”‚ â”‚              â”‚ â”‚  generate_physics_  â”‚
â”‚ â€¢ Balance channels   â”‚ â”‚ OUTPUT #6:   â”‚ â”‚  pdf]               â”‚
â”‚   â†“                  â”‚ â”‚ kelly_alpha_ â”‚ â”‚                     â”‚
â”‚ [diffuse.flatten_    â”‚ â”‚ soft_8k.png  â”‚ â”‚ Chair frame specs:  â”‚
â”‚  contrast]           â”‚ â”‚              â”‚ â”‚ â€¢ Rigid body        â”‚
â”‚ â€¢ Reduce 15%         â”‚ â”‚ OUTPUT #7:   â”‚ â”‚ â€¢ Density: 700kg/mÂ³ â”‚
â”‚   â†“                  â”‚ â”‚ kelly_alpha_ â”‚ â”‚ â€¢ Restitution: 0.1  â”‚
â”‚ Apply to:            â”‚ â”‚ tight_8k.png â”‚ â”‚                     â”‚
â”‚ â€¢ Square sprite      â”‚ â”‚              â”‚ â”‚ Fabric specs:       â”‚
â”‚ â€¢ 16:9 hero          â”‚ â”‚ OUTPUT #8:   â”‚ â”‚ â€¢ Soft cloth        â”‚
â”‚   â†“                  â”‚ â”‚ kelly_hair_  â”‚ â”‚ â€¢ Stiffness: 0.85   â”‚
â”‚ OUTPUT #4:           â”‚ â”‚ edge_matte_  â”‚ â”‚                     â”‚
â”‚ kelly_diffuse_       â”‚ â”‚ 8k.png       â”‚ â”‚ Hair specs:         â”‚
â”‚ neutral_8k.png       â”‚ â”‚              â”‚ â”‚ â€¢ Spring chain      â”‚
â”‚ (8192Ã—8192)          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â€¢ Damping: 2.2      â”‚
â”‚   â†“                  â”‚                  â”‚                     â”‚
â”‚ OUTPUT #5:           â”‚                  â”‚ Camera: 35mm, 8K    â”‚
â”‚ kelly_chair_diffuse_ â”‚                  â”‚   â†“                 â”‚
â”‚ neutral_8k.png       â”‚                  â”‚ OUTPUT #9:          â”‚
â”‚ (7680Ã—4320)          â”‚                  â”‚ kelly_physics_      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ reference_sheet.pdf â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  STEP 10: VIDEO (OPTIONAL)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [video_frame.extract_midframe]                                     â”‚
â”‚  â€¢ Read frame at ~2 seconds                                         â”‚
â”‚  â€¢ Crop to 16:9                                                     â”‚
â”‚  â€¢ Scale to 8K                                                      â”‚
â”‚    â†“                                                                 â”‚
â”‚  OUTPUT #10: kelly_video_midframe_8k.png                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FINAL OUTPUTS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ“ 1.  kelly_directors_chair_8k_transparent.png (7680Ã—4320, RGBA)  â”‚
â”‚  âœ“ 2.  kelly_directors_chair_8k_dark.png (7680Ã—4320, RGB)          â”‚
â”‚  âœ“ 3.  kelly_front_square_8k_transparent.png (8192Ã—8192, RGBA)     â”‚
â”‚  âœ“ 4.  kelly_diffuse_neutral_8k.png (8192Ã—8192, RGB)               â”‚
â”‚  âœ“ 5.  kelly_chair_diffuse_neutral_8k.png (7680Ã—4320, RGB)         â”‚
â”‚  âœ“ 6.  kelly_alpha_soft_8k.png (7680Ã—4320, L)                      â”‚
â”‚  âœ“ 7.  kelly_alpha_tight_8k.png (7680Ã—4320, L)                     â”‚
â”‚  âœ“ 8.  kelly_hair_edge_matte_8k.png (7680Ã—4320, L)                 â”‚
â”‚  âœ“ 9.  kelly_physics_reference_sheet.pdf                            â”‚
â”‚  âœ“ 10. kelly_video_midframe_8k.png (7680Ã—4320, RGB, optional)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CLI Command Flow

```
$ python -m kelly_pack.cli build --outdir ./output

    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Parse CLI arguments    â”‚
â”‚  â€¢ Input files          â”‚
â”‚  â€¢ Output directory     â”‚
â”‚  â€¢ Tuning parameters    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auto-detect inputs     â”‚
â”‚  [io_utils.find_first_  â”‚
â”‚   existing]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load hero image        â”‚
â”‚  [io_utils.load_image]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Prepare 16:9 (8K)      â”‚
â”‚  [crop_scale]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Generate alpha (2K)    â”‚
â”‚  [matting]              â”‚
â”‚  â€¢ Try model-based      â”‚
â”‚  â€¢ Fallback heuristic   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Upsample to 8K         â”‚
â”‚  [guided filter]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Generate variants      â”‚
â”‚  [alpha_tools]          â”‚
â”‚  â€¢ Soft                 â”‚
â”‚  â€¢ Tight                â”‚
â”‚  â€¢ Edge                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Create outputs         â”‚
â”‚  â€¢ Transparent hero     â”‚
â”‚  â€¢ Dark hero            â”‚
â”‚  â€¢ Square sprite        â”‚
â”‚  â€¢ Diffuse neutrals     â”‚
â”‚  â€¢ Physics sheet        â”‚
â”‚  [composite, diffuse,   â”‚
â”‚   physics_sheet]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Save all outputs       â”‚
â”‚  [io_utils.save_image]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Print summary          â”‚
â”‚  âœ“ ALL 10 FILES SAVED   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Parameter Tuning Flow

```
Default â†’ Try â†’ Adjust if needed

Soft Alpha:
  --soft-blur 2.0    â†’ Hair on light UI looks harsh?
                     â†’ Increase to 3.0â€“4.0

  --soft-bias 0.05   â†’ Need more halo?
                     â†’ Increase to 0.08â€“0.10

Tight Alpha:
  --tight-blur 1.0   â†’ Hair on dark UI has halo?
                     â†’ Decrease to 0.5

  --tight-bias -0.03 â†’ Still see halo?
                     â†’ Decrease to -0.05 to -0.08

  --tight-erode 1    â†’ Need tighter edges?
                     â†’ Increase to 2â€“3

Dark Gradient:
  --grad-top #22262A    â†’ Want different mood?
  --grad-bottom #080808 â†’ Adjust hex colors

Square Sprite:
  --padding-frac 0.10  â†’ Subject too small?
                       â†’ Decrease to 0.05
                       â†’ Subject too large?
                       â†’ Increase to 0.15

Diffuse:
  --contrast-flatten 0.15 â†’ Too flat?
                          â†’ Decrease to 0.08â€“0.10
                          â†’ Need flatter?
                          â†’ Increase to 0.20
```

---

## Error Handling Flow

```
Try model-based matting
    â”‚
    â”œâ”€ Success â†’ Use model alpha
    â”‚
    â””â”€ Fail (PyTorch not available, weights error, etc.)
         â†“
       Print warning
         â†“
       Fall back to heuristic matting
         â†“
       Success â†’ Use heuristic alpha

Result: Always get valid alpha, never crash
```

---

## Performance Optimization

```
Input Image (e.g., 4000Ã—3000)
    â†“
Scale to 16:9 @ 8K (7680Ã—4320)  â† High quality Lanczos
    â†“
Downscale to 2K (2560Ã—1440)     â† For matting (fast)
    â†“
Run matting on 2K               â† GPU: ~2s, CPU: ~15s
    â†“
Upsample alpha to 8K            â† Edge-aware guided filter
    â†“
All other ops at 8K             â† No further downscaling

Result: Fast matting + high-quality output
```

---

## Validation Checklist

After generation, validate:

```
âœ“ Hair on Dark Mode
  â†’ Open kelly_directors_chair_8k_dark.png
  â†’ Check: No white halo around hair
  â†’ Expected: Clean dark gradient

âœ“ Hair on Light Mode
  â†’ Open kelly_alpha_soft_8k.png
  â†’ Composite over white background
  â†’ Check: Graceful wispy halo
  â†’ Expected: Natural falloff

âœ“ Transparent Alignment
  â†’ Overlay kelly_directors_chair_8k_transparent.png on dark hero
  â†’ Check: Pixel-perfect alignment
  â†’ Expected: Exact match

âœ“ Square Sprite
  â†’ Open kelly_front_square_8k_transparent.png
  â†’ Check: Centered, ~10% padding
  â†’ Expected: Subject occupies ~80% of canvas

âœ“ Diffuse Quality
  â†’ Open kelly_diffuse_neutral_8k.png
  â†’ Check: Balanced channels, reduced contrast
  â†’ Expected: "Flat" texture for relighting
```

---

**Complete workflow documented!** ğŸ“Š

**See also:**
- [INDEX.md](INDEX.md) â€” Documentation index
- [README.md](README.md) â€” Full documentation
- [DEMO.md](DEMO.md) â€” Example scenarios


